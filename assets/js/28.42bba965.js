(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{401:function(t,s,a){"use strict";a.r(s);var e=a(4),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("Info",{attrs:{title:"Vous trouverez les sources du module réalisé dans cet article sur le dépôt GitHub suivant : PrestaEdit/modulenine"}}),t._v(" "),s("h2",{attrs:{id:"preambule"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#preambule"}},[t._v("#")]),t._v(" Préambule")]),t._v(" "),s("p",[t._v("Lors du développement d'un module, on se retrouve fort souvent à réaliser celui-ci sur une seule et même instance et principalement sur une version plus récente de PrestaShop.")]),t._v(" "),s("p",[t._v("Cependant, "),s("strong",[t._v("les utilisateurs de ces modules ne sont pas systématiquement sur le même socle")]),t._v(".")]),t._v(" "),s("p",[t._v("Au fil des versions, mineures comme majeures, PrestaShop introduit des changements de codes qui peuvent avoir des répercussions sur le bon fonctionnement du module.")]),t._v(" "),s("p",[t._v("Malgré tout, réaliser un test sur chaque version de PrestaShop manuellement et lors de chaque lot d'utilisation de nouvelles méthodes est fastidieux.")]),t._v(" "),s("p",[t._v("Réaliser ces tests en fin de développement peut également s'avérer plus compliqué que prévu, pour peu que tout un pan de code ne soit pas rétro-compatible.")]),t._v(" "),s("p",[t._v("Voyons dès lors comment tester - "),s("strong",[t._v("automatiquement")]),t._v(" - le code de son module pour une compatibilité sur toutes versions.")]),t._v(" "),s("h2",{attrs:{id:"phpstan"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#phpstan"}},[t._v("#")]),t._v(" PhpStan")]),t._v(" "),s("h3",{attrs:{id:"introduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://phpstan.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHPStan"),s("OutboundLink")],1),t._v(" est un outil d'analyse statique de code spécifique à PHP.")]),t._v(" "),s("p",[t._v("Il analyse votre code à la recherche d'erreurs et de problèmes potentiels, vous aidant ainsi à améliorer la qualité de votre code et à éviter les erreurs courantes.")]),t._v(" "),s("p",[t._v("Au niveau de PrestaShop, vous pouvez d'ores et déjà utiliser PhpStan en dehors de ce projet. Pour cela, voyez la "),s("a",{attrs:{href:"https://devdocs.prestashop-project.org/1.7/modules/testing/advanced-checks/#static-analysis",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation officielle"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[t._v("#")]),t._v(" Configuration")]),t._v(" "),s("p",[t._v("Avant de rentrer dans le vif du sujet, explorons tout d'abord la configuration nécessaire.")]),t._v(" "),s("p",[t._v("Nous allons créer deux fichiers de script shell.")]),t._v(" "),s("Warning",{attrs:{title:"Dans notre illustration, nous utilisons le nom du module directement dans le fichier, sans passer par une variable."}}),t._v(" "),s("p",[s("em",[t._v("A ce propos, vous pourriez passer le nom du module directement dans le workflow GitHub en utilisant le nom du dépôt. Ceci ne sera pas couvert dans le présent article.")])]),t._v(" "),s("p",[s("strong",[t._v("/tests/phpstan.sh")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PS_VERSION")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Docker images prestashop/prestashop may be used, even if the shop remains uninstalled")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Pull PrestaShop files (Tag '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${PS_VERSION}")]),t._v(')"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" temp-ps "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" ps-volume "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-tid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" ps-volume:/var/www/html "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" temp-ps prestashop/prestashop:"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PS_VERSION")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run a container for PHPStan, having access to the module content and PrestaShop sources.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This tool is outside the composer.json because of the compatibility with PHP 5.6")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Run PHPStan using phpstan-'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${PS_VERSION}")]),t._v('.neon file"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" --volumes-from temp-ps "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PWD")]),t._v(":/var/www/html/modules/modulenine "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("_PS_ROOT_DIR_")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/www/html "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workdir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/www/html/modules/modulenine phpstan/phpstan:0.12.54 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       analyse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--configuration")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/www/html/modules/modulenine/tests/phpstan/phpstan-"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PS_VERSION")]),t._v(".neon\n")])])]),s("p",[s("strong",[t._v("/tests/phpstan-v9.sh")])]),t._v(" "),s("Info",{attrs:{title:"Celui-ci est nécessaire pour permettre l'utilisation du registre prestaedit/prestashop en lieu et place de prestashop/prestashop. L'image Docker de PrestaShop 9 n'étant disponible que lors de sa release officielle."}}),t._v(" "),s("p",[t._v("Par ailleurs, la version de PhpStan utilisée est différente. Celle-ci étant compatible avec PHP8.1, notamment.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PS_VERSION")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Docker images prestashop/prestashop may be used, even if the shop remains uninstalled")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Pull PrestaShop files (Tag '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${PS_VERSION}")]),t._v(')"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" ps9-php8 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" ps9-php8 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-tid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" ps9-php8:/var/www/html "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" ps9-php8 prestaedit/prestashop:"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PS_VERSION")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" ps9-php8 php "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run a container for PHPStan, having access to the module content and PrestaShop sources.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This tool is outside the composer.json because of the compatibility with PHP 5.6")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Run PHPStan using phpstan-'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${PS_VERSION}")]),t._v('.neon file"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rm")]),t._v(" --volumes-from ps9-php8 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PWD")]),t._v(":/var/www/html/modules/modulenine "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("_PS_ROOT_DIR_")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/www/html "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--workdir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/www/html/modules/modulenine ghcr.io/phpstan/phpstan:nightly-php8.1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       analyse "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--configuration")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/www/html/modules/modulenine/tests/phpstan/phpstan-"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PS_VERSION")]),t._v(".neon\n")])])]),s("p",[t._v("Ensuite, nous allons ajouter l'ensemble des fichiers correspondant à une version de PrestaShop testée. Ceux-ci porteront l'extension "),s("em",[t._v(".neon")]),t._v(".")]),t._v(" "),s("p",[t._v("Son contenu de base sera le suivant :")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("includes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" %currentWorkingDirectory%/vendor/prestashop/php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("dev"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("tools/phpstan/ps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("extension.neon\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parameters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("paths")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# From PHPStan 0.12, paths to check are relative to the neon file")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ../../modulenine.php\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ../../classes/\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ../../controllers/\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("reportUnmatchedIgnoredErrors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ignoreErrors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),s("h4",{attrs:{id:"a-propos-de-ps-module-extension-neon"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#a-propos-de-ps-module-extension-neon"}},[t._v("#")]),t._v(" A propos de ps-module-extension.neon")]),t._v(" "),s("p",[t._v("Ce premier fichier de configuration va se charger de définir des constantes utiles et relatives à une instance PrestaShop. Il se chargera également de définir des "),s("em",[t._v("stubs")]),t._v(" concernant la classe Module et Tab.")]),t._v(" "),s("p",[t._v("Par la suite, nous mettrons en place un workflow testant le module à la fois sous PrestaShop 1.6.1.23, 1.7.8, 8.1.7 et 9.0.0-alpha.1.")]),t._v(" "),s("p",[t._v("Nous aurons donc ces quatre fichiers :")]),t._v(" "),s("ul",[s("li",[t._v("tests/phpstan/phpstan-1.6.1.23.neon")]),t._v(" "),s("li",[t._v("tests/phpstan/phpstan-1.7.8.neon")]),t._v(" "),s("li",[t._v("tests/phpstan/phpstan-8.1.7.neon")]),t._v(" "),s("li",[t._v("tests/phpstan/phpstan-9.0.0-alpha.1.neon")])]),t._v(" "),s("p",[t._v("Tout comme moi, vous auriez l'envie de modifier l'appel des fichiers de configuration de PhpStan que nous écrirons plus tard pour utiliser un seul et unique fichier, puisque le contenu est équivalent.")]),t._v(" "),s("p",[s("strong",[t._v("Mais, non, vous ne le ferez pas.")])]),t._v(" "),s("p",[t._v("Ce découpage en fichier nous sera nécessaire par la suite.")]),t._v(" "),s("h2",{attrs:{id:"module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#module"}},[t._v("#")]),t._v(" Module")]),t._v(" "),s("p",[t._v("Pour le bien de notre article et pour la suite de la lecture, nous allons concevoir un module qui a pour but d'illustrer le retour des erreurs.")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("ModuleNine")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Module")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("__construct")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'modulenine'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword static-context"}},[t._v("parent")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__construct")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("prestashop16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Methods are more times deprecated, but not removed.")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// So, use a newer one")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$temp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EmployeeSession")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("prestashop17")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Methods are more times deprecated, but not removed, again.")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// So, use a newer one")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$temp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomerSession")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("prestashop8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$temp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Carrier")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCarrierNameFromShopName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("prestashop9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$temp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Order")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$temp")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDiscounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),s("p",[t._v("En tant que développeur aguerri, vous pourriez omettre une objection assez rapidement et pour laquelle vous auriez raison de le faire : les appels aux méthodes inexistantes pour telle ou telle version de PrestaShop le sont dans des méthodes isolées et jamais appelée par notre module.\nDès lors, l'utilisation de ce module sur une version incriminée de PrestaShop ne poserait pas de problèmes, dans l'immédiat.")]),t._v(" "),s("p",[t._v("L'analyse de code étant "),s("strong",[t._v("réalisée de manière statique")]),t._v(" et sans votre oeil de développeur, une erreur vous sera malgré tout annoncée.")]),t._v(" "),s("p",[t._v("Prenez la au sérieux et veillez à la traiter avec des conditions dès que possible. D'autant qu'il s'agit de code non utilisé mais qui se doit d'être corrigé (ou d'être supprimé, le cas échéant !).")]),t._v(" "),s("p",[t._v("Voici un rendu de la console GitHub lors de l'exécution de nos jobs. "),s("em",[t._v("Durant ce test, nous n'avions pas encore mis d'erreurs dans les fonctions pour PrestaShop 1.6 et 1.7.")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/posts/2024-11-06-tester-son-module-via-ci-cd/02.png"),alt:"Capture"}}),t._v(" "),s("p",[t._v("En visualisant le détail d'un job en erreur, vous pourrez obtenir l'information souhaitée :")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/posts/2024-11-06-tester-son-module-via-ci-cd/03.png"),alt:"Capture"}}),t._v(" "),s("p",[t._v("En modifiant le module comme suit, afin d'ajouter une condition sur l'exécution du code, vous pouvez relancer votre job et l'erreur aura disparue.")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("prestashop8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("version_compare")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("_PS_VERSION_")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'8.0.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'<'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$temp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Carrier")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCarrierNameFromShopName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Vous venez de relancer le job et l'erreur n'a pas disparue ?!")]),t._v(" "),s("p",[s("em",[t._v("Oups, je vous ai menti.")])]),t._v(" "),s("p",[t._v("En réalité, PhpStan - "),s("em",[t._v("bien qu'il connaisse la valeur de la constante "),s("em",[t._v("PS_VERSION")])]),t._v(" - "),s("strong",[t._v("n'est pas en mesure d'interpréter la conditionnelle")]),t._v(" au même titre qu'il ne sait pas que vos méthodes ne sont jamais appelées.")]),t._v(" "),s("p",[t._v("De ce fait, l'analyse de code statique retournera toujours l'erreur rencontrée.")]),t._v(" "),s("p",[t._v("Une fois celle-ci traitée, vous allez pouvoir modifier votre fichier neon sur la version concernée (d'où la séparation précédente) pour lui dire d'ignorer l'erreur.")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parameters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ignoreErrors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'~^Call to an undefined static method Carrier::getCarrierNameFromShopName\\(\\)\\.$~'")]),t._v("\n")])])]),s("h2",{attrs:{id:"workflow-github"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#workflow-github"}},[t._v("#")]),t._v(" Workflow GitHub")]),t._v(" "),s("p",[t._v("Pour le bien de cet article, nous avons souhaités commencer par l'introduction et le résultat attendu quant à l'utilisation de PhpStan.")]),t._v(" "),s("p",[t._v("Dans l'idée de rentre cela plus "),s("strong",[t._v("automatique")]),t._v(", nous allons désormais écrire la configuration du workflow GitHub.")]),t._v(" "),s("p",[s("strong",[t._v(".github/workflows/php.yml")])]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP tests\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("workflow_dispatch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pull_request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php-linter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP Syntax check 7.1 ="),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" 8.3\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.04")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v4\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 7.1\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/7.1@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 7.2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/7.2@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 7.3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/7.3@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 7.4\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/7.4@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 8.0\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/8.0@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 8.1\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/8.1@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 8.2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/8.2@master\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP syntax checker 8.3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashop/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("lint/8.3@master\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php-cs-fixer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("CS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Fixer\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.04")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v4\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Run PHP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("CS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Fixer\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prestashopcorp/github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("fixer@master\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("other-cmds")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--config=.php-cs-fixer.dist.php"')]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Run PHPStan against the module and a PrestaShop release")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("phpstan-v16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHPStan\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("continue-on-error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("strategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matrix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("presta-versions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.6.1.23"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup PHP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" shivammathur/setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php@v2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php-version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"7.1"')]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v3.1.0\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add vendor folder in cache to make next builds faster")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cache vendor folder\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vendor\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hashFiles('composer.lock') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add composer local folder in cache to make next builds faster")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cache composer folder\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ~/.composer/cache\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("composer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cache\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" composer install\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Docker images prestashop/prestashop may be used, even if the shop remains uninstalled")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Execute PHPStan on PrestaShop (Tag $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.presta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("versions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chmod +x ./tests/phpstan.sh "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(" ./tests/phpstan.sh $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.presta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("versions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("phpstan")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHPStan\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("continue-on-error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("strategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matrix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("presta-versions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.7.8"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.1.7"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup PHP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" shivammathur/setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php@v2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php-version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"7.4"')]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v3.1.0\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add vendor folder in cache to make next builds faster")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cache vendor folder\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vendor\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hashFiles('composer.lock') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add composer local folder in cache to make next builds faster")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cache composer folder\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ~/.composer/cache\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("composer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cache\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" composer install\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Docker images prestashop/prestashop may be used, even if the shop remains uninstalled")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Execute PHPStan on PrestaShop (Tag $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.presta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("versions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chmod +x ./tests/phpstan.sh "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(" ./tests/phpstan.sh $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.presta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("versions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("phpstan-v9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PHPStan\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("strategy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matrix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("presta-versions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9.0.0-alpha.1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Setup PHP\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" shivammathur/setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("php@v2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("php-version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8.1"')]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v4\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add vendor folder in cache to make next builds faster")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cache vendor folder\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vendor\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" hashFiles('composer.lock') "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Add composer local folder in cache to make next builds faster")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cache composer folder\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/cache@v3\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ~/.composer/cache\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" php"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("composer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cache\n\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" composer install\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Docker images prestashop/prestashop may be used, even if the shop remains uninstalled")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Execute PHPStan on PrestaShop (Tag $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.presta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("versions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" chmod +x ./tests/phpstan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v9.sh "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("&&")]),t._v(" ./tests/phpstan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("v9.sh $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" matrix.presta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("versions "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Lors de chaque pull request effectuée sur le dépôt ou via un lancement automatique - grâce à l'évènement "),s("em",[t._v("workflow_dispatch")]),t._v(" -, vous pourrez lancer l'ensemble des jobs définit précédemment.")]),t._v(" "),s("Info",{attrs:{title:"En allant plus loin, vous pourrez remarquer que nous utilisons également une vérification syntaxique pour un ensemble de versions de PHP mais également de PHP CS Fixer.Ces étapes ne faisant pas partie de notre article, nous ne les évoquerons pas plus en détails."}}),t._v(" "),s("h2",{attrs:{id:"alternative-locale-act"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#alternative-locale-act"}},[t._v("#")]),t._v(" Alternative locale : act")]),t._v(" "),s("p",[t._v("Lors du développement d'un module comme lors de tout développement, vous n'allez pas forcément pousser les modifications sur git à chaque fonction.")]),t._v(" "),s("p",[t._v("Dès lors, le workflow GitHub n'étant activé que lors d'une poussée de code et sur le code disponible dans le dépôt au moment de son exécution, vous ne pourriez pas visualiser les problématiques "),s("strong",[t._v("en cours de développement")]),t._v(".")]),t._v(" "),s("p",[t._v("Pour ce faire, vous pouvez utiliser "),s("a",{attrs:{href:"https://nektosact.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v('nektos/act, "Run your GitHub Actions locally"'),s("OutboundLink")],1),t._v(" pour utiliser un runner localement.")]),t._v(" "),s("Warning",{attrs:{title:"Les workflows utilisant des images Docker, vous aurez besoin de lancer Docker (Desktop, par exemple)."}}),t._v(" "),s("p",[t._v("L'avantage de cette solution, en plus d'être locale, est la possibilité d'utiliser "),s("strong",[t._v("le même workflow que celui définit dans GitHub")]),t._v(" sans devoir le transposer sur une solution ayant sa propre nomenclature.")]),t._v(" "),s("p",[t._v("Concernant son installation, je vous laisse le soin de choisir la méthode la plus adéquate pour votre environnement. Travaillant sous MacOs, l'installation via Homebrew a été préférée.")]),t._v(" "),s("p",[t._v("En ligne de commande, à la racine de votre dépôt, vous pourrez désormais écrire cet appel pour lancer l'ensemble de vos jobs :")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("act workflow_dispatch\n")])])]),s("Info",{attrs:{title:"On précise l'event GitHub pour que act sache quels jobs lancer"}}),t._v(" "),s("p",[t._v("Vous pouvez également "),s("strong",[t._v("préciser un fichier de workflow")]),t._v(" en particulier :")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("act workflow_dispatch "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-W")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.github/workflows/php.yml'")]),t._v("\n")])])]),s("p",[t._v("Ou encore, vous pouvez obtenir "),s("strong",[t._v("la liste des jobs disponibles")]),t._v(" dans votre workflow et y faire un appel direct :")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("act "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--list")]),t._v("\n")])])]),s("p",[t._v("Et dès lors réaliser "),s("strong",[t._v("un appel direct")]),t._v(" de ce type (en omettant l'évènement GitHub) :")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("act "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'php-linter'")]),t._v("\nact "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'phpstan-v9'")]),t._v("\n")])])]),s("p",[t._v("Vous devriez obtenir un résultat similaire à la sortie de console de GitHub.")]),t._v(" "),s("img",{attrs:{src:t.$withBase("/posts/2024-11-06-tester-son-module-via-ci-cd/01.png"),alt:"Capture"}}),t._v(" "),s("h3",{attrs:{id:"probleme-de-parallelisme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#probleme-de-parallelisme"}},[t._v("#")]),t._v(" Problème de parallélisme")]),t._v(" "),s("p",[t._v("Par facilité et afin de lancer le même job sur une série de versions de PrestaShop, nous utilisons une matrice dans le workflow GitHub.")]),t._v(" "),s("p",[t._v("Or, via Act, cela peut poser soucis d'exécution concurrente.")]),t._v(" "),s("p",[t._v("Vous pouvez dès lors optez pour modifier votre workflow afin de ne pas utiliser de matrices ou alors vous pouvez altérer la matrice sans modifier votre configuration.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("act "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-j")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'phpstan'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--matrix")]),t._v(" presta-versions:8.1.7\n")])])])],1)}),[],!1,null,null,null);s.default=n.exports}}]);